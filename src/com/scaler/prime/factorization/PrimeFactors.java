package com.scaler.prime.factorization;

import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import java.util.stream.Collectors;

public class PrimeFactors {

    public static int[] sieve(int n,Map<Integer,Integer> numWithSpf){
        int[] spf= new int[n+5];
        for(int i=0;i<n+5;i++){
            spf[i]=i;
        }

        for(int i=2;i*i<=n;i++){
            if(spf[i]==i){
                int count=0;
                for(int m=i;m*i<=n;m++){
                    if(spf[m*i]>i){
                        spf[m*i]=i;
                        count++;
                        /*if(numWithSpf.containsKey(i)){
                            int val=numWithSpf.get(i);
                            numWithSpf.put(i,val+1);
                        }
                        else{
                            numWithSpf.put(i,1);
                        }*/
                    }
                }
                numWithSpf.put(i,count);
            }
        }

        return spf;
    }

    public static int[] solve(int A, int[] B) {

        Map<Integer,Integer> numWithSpf= new HashMap<>();
        sieve((int)1e6+5,numWithSpf);

        int n=B.length;

        int[] count=new int[n];
        for(int i=0;i<A;i++){
            int num=B[i];
            count[i]+=1;// Since the prime number also will be counted
            count[i]+=numWithSpf.get(num)!=null?numWithSpf.get(num):0;
            //count[i]+=numWithSpf.entrySet().stream().filter(map->map.getValue().equals(num)).collect(Collectors.toList()).size();
           /* for(int j=num;(long)j*num<(1e6+10);j++){
                if(spf[j*num]==num){
                    count[i]++;
                }
            }*/
        }

        return count;
    }
    public static void main(String[] args) {

        //System.out.println(Arrays.toString(solve(1,new int[]{63199})));
       // System.out.println(Arrays.toString(solve(1,new int[]{11})));
        //System.out.println(Arrays.toString(solve(1,new int[]{  , 19, 246193, 161039, 122701, 16069, 223637, 295769, 303691, 188443, 103561, 333779, 272093, 367229, 354451, 196181, 44893, 165587, 78583, 328051, 69163, 294181, 320401, 384733, 385943, 225221, 138209, 90071, 101737, 319069, 5927, 131891, 27803, 251861, 15797, 1879, 351691, 93629, 92593, 215723, 257671, 318107, 272009, 174673, 67547, 279137, 168193, 163901, 364499, 279511, 33107, 220169, 135511, 275573, 224201, 209441, 126229, 48259, 74821, 150989, 303817, 187277, 381859, 282299, 120277, 54421, 243889, 177433, 18181, 261229, 182549, 46771, 364669, 44641, 346043, 258353, 103991, 151517, 20411, 372061, 254329, 48823, 334379, 311659, 213289, 62467, 57529, 309667, 170851, 49633, 182179, 274333, 143401, 95063, 208009, 253937, 284159, 270163, 170857, 38197, 128749, 316907, 9293, 187223, 246173, 151391, 31981, 364571, 352711, 200293, 120431, 169567, 131519, 321821, 109201, 163169, 92243, 378919, 101921, 277231, 207481, 64109, 286453, 318809, 140269, 181001, 339769, 7001, 383839, 209519, 14033, 192961, 63463, 320149, 231271, 244033, 64879, 319831, 38299, 33623, 278879, 108191, 361213, 97499, 116731, 44171, 274831, 316891, 264643, 220687, 280627, 85049, 45691, 251, 17389, 305111, 324223, 69497, 35591, 201809, 3323, 34949, 162593, 282589, 255511, 197837, 21577, 155453, 66361, 259691, 99109, 155443, 77527, 211507, 193451, 232007, 51329, 182279, 370471, 259531, 354139, 61933, 116539, 57709, 384079, 163697, 385261, 29411, 230551, 28433, 155783, 357031, 13397, 341629, 98993, 75617, 289721, 145463, 66373, 231779, 222199, 161377, 167267, 219749, 234613, 325021, 314491, 230383, 269713, 206909, 131611, 59743, 276707, 202591, 346039, 81343, 61553, 222461, 260677, 214363, 122389, 178513, 23677, 277897, 225427, 228797, 257639, 304481, 47389, 210811, 330331, 348637, 226511, 272417, 11821, 248063, 376099, 108533, 208213, 104971, 56179, 33199, 330877, 323597, 279443, 49409, 113089, 23327, 22447, 237271, 310867, 198469, 160049, 144751, 102217, 167017, 181141, 48647, 111623, 276763, 108127, 313669, 368579, 332711, 271393, 102679, 362347, 39667, 18947, 296437, 190313, 224461, 367307, 21061, 333667, 242453, 111253, 32027, 182627, 75541, 99089, 352181, 200989, 246119, 35227, 177787, 133109, 179381, 299993, 184279, 134363, 256313, 193301, 223099, 139333, 1181, 264601, 30553, 229763, 328481, 177269, 280697, 179407, 133481, 296563, 201673, 124633, 367163, 232937, 57073, 131251, 41213, 278911, 365527, 225373, 7127, 114217, 15731, 236527, 41213, 321833, 328961, 219407, 270059, 324757, 3449, 39371, 264619, 227501, 72031, 19031, 54413, 230143, 118493, 110233, 128659, 245383, 303619, 305401, 191099, 225077, 301907, 344171, 45823, 232669, 142031, 85427, 42793, 325189, 19087, 151909, 209801, 103669, 199697, 74941, 107069, 33857, 305839, 42223, 96763, 297719, 341911, 298349, 279173, 226697, 126143, 325769, 76039, 328637, 76423, 83843, 197419, 379667, 15101, 24001, 190339, 151579, 28537, 87337, 340393, 77617, 46471, 38921, 357083, 23603, 12967, 16649, 116789, 349939, 140617, 153929, 363317, 317921, 194083, 319819, 258607, 140281, 87509, 823, 190717, 366841, 140639, 80737, 214691, 85991, 254753, 362951, 154981, 339811, 1487, 361159, 221203, 296831, 211063, 44927, 73819, 134677, 811, 148249, 24229, 244873, 325163, 18583, 307079, 245759, 257797, 303727, 192547, 255259, 45061, 256939, 272537, 293269, 8101, 330731, 238727, 264029, 25409, 201359, 363959, 16657, 93283, 45959, 378407, 228619, 99823, 353161, 128657, 258977, 72421, 49757, 80557, 189043, 344843, 32503, 344963, 157411, 23603, 295153, 55457, 375247, 292493, 331451, 69539, 163367, 683, 281923, 35069, 142969, 106963, 383041, 10313, 84787, 61651, 83101, 48947, 228773, 337691, 360197, 63977, 294181, 239171, 243647, 347707, 162901, 352637, 246641, 47947, 235231, 208319, 149771, 361967, 196717, 211789, 195053, 86029, 139987, 122027, 9739, 300743, 64319, 20393, 136999, 216917, 20627, 64811, 49747, 238673, 162527, 222311, 260191, 157259, 254911, 139831, 317351, 217463, 65519, 364621, 333787, 137941, 380819, 60149, 342077, 210173, 157543, 231463, 264839, 13757, 97283, 87803, 144223, 341951, 265513, 272777, 342233, 138617, 140191, 345571, 106109, 136531, 208697, 123289, 275047, 279863, 276079, 277309, 43867, 65677, 92467, 253307, 348457, 128761, 187471, 33487, 346961, 66763, 187633, 242819, 156139, 256093, 27031, 23417, 22153, 7121, 123821, 105527, 260179, 45007, 139199, 19603, 251263, 271357, 65171, 258737, 226907, 242867, 198047, 29717, 198593, 13757, 375283, 166409, 373447, 272533, 192833, 252979, 258329, 130379, 136727, 13873, 306533, 54601, 17341, 106759, 296213, 70241, 111149, 174583, 1993, 156719, 183707, 222979, 285151, 141551, 121867, 320039, 361679, 229837, 384941, 14969, 205703, 328633, 136099, 105251, 96757, 6803, 225613, 137723, 4507, 8093, 162997, 326309, 359137, 141829, 272329, 225241, 305999, 333539, 213533, 218657, 23203, 299933, 165617, 216877, 216379, 208213, 309241, 250007, 119563, 2267, 90481, 118739, 77419, 290489, 130259, 331249, 36061, 271637, 232103, 341333, 59351, 194717, 344749, 294317, 371389, 64667, 344497, 301601, 366227, 322571, 339839, 232013, 60217, 227453, 89659, 84247, 274441, 297719, 55117, 266983, 173081, 24019, 305243, 325231, 38749, 105613, 209789, 170021, 286697, 62633, 272453, 384017, 3607, 240007, 257867, 56263, 21017, 93283, 251609, 318601, 203227, 130057, 294149, 77551, 236107, 77267, 67289, 373969, 95791, 5701, 289763, 48371, 12923, 2003, 121367, 238463, 119417, 146933, 147671, 27103, 198503, 260999, 117361, 244003, 333923, 194687, 208493, 15149, 167071, 87721, 151579, 328519, 175447, 26053, 206917, 265193, 293659, 328919, 323341, 100151, 329009, 238879, 280537, 314407, 288359, 332069, 347287, 349093, 189307, 156841, 32917, 123449, 312233, 151897, 54709, 109, 243973, 291491, 18229, 26839, 135647, 254729, 305633, 49123, 45119, 13399, 120551, 4483, 376891, 240007, 15061, 349787, 235783, 153457, 5189, 81223, 138053, 242509, 295049, 5689, 313399, 43543, 234461, 200671, 379103, 166183, 71081, 103001, 295199, 119101, 172969, 223823, 31183, 379501, 284153, 47977, 163307, 266083, 385571, 292363, 237619, 229127, 363277, 256313, 98927, 207457, 99119, 199753, 266369, 82609, 199103, 177811, 365641, 248821, 288181, 229847, 159119, 302189, 279967, 381413, 67307, 232391, 347969, 217169, 351479, 182813, 176461, 160649, 339389, 360869, 59281, 84731, 66749, 273719, 361219, 230501, 11197, 237401, 9133, 203051, 198257, 159349, 17489, 384403, 39839, 220907, 13997, 55813, 245029, 115259, 108907, 242371, 145417, 151813, 73561, 252391, 53527, 179603, 183593, 303731, 154799, 859, 117889, 131893, 40123, 313931, 274871, 340201, 238247, 241229, 186239, 275159, 276389, 367721, 167081, 127037, 34421, 345817, 311419, 162683, 33247, 331081, 286459, 10487, 147727, 358879, 19577, 52957, 69847, 36073, 217081, 36583, 227993, 212467, 257293, 274163, 350429, 248789, 102139, 306193, 132749, 385057, 291077, 67219, 54983, 136573, 58699, 212897, 63949, 369079, 62017, 134161, 104311, 37397, 65003, 12697, 290533, 286333, 335941, 277, 160183, 151451, 303337, 165331, 178627, 281527, 79813, 204361, 27827, 352973, 341303, 325901, 16943, 176989, 233489, 280627, 284233, 86201, 347987, 299401, 65521, 201683, 14323, 189377, 298691, 263089, 6047, 274213, 201833, 349801, 333623, 301409, 104827, 139267, 173531, 14731, 241711, 109, 289469, 284267, 72859, 49367, 16229, 249133, 8609, 120397, 260419, 301901, 155291, 378379, 234931, 101051, 171571, 333139, 23311, 30689, 45247, 45139, 351343, 106163, 131063, 308311, 12823, 308489, 80317, 343037, 86441, 91283, 68543, 76403, 321449, 333341, 338579, 320911, 224303, 11069, 56041, 59567, 124171, 160481, 60089, 341587, 229759, 198959, 348709, 189493, 273797, 385811, 373187, 330229, 319097, 46507, 131311, 96797, 55127, 375043, 278387, 267899, 8059, 238921, 307733, 275939, 310117, 38749, 268927, 131581, 240893, 350293, 339601, 8431, 291457, 160313, 1579, 76099, 148483, 49993, 351773, 181303, 81343, 283583, 346553, 70619, 8423, 290533, 75979, 203213, 305147, 323987, 114913, 196033, 382709, 331031, 239699, 75743, 307823, 129971, 128413, 9257, 205133, 140351, 37019, 112291, 343489, 66137, 360817, 38917, 322771, 341333, 159023, 73709, 234629, 204601, 230123, 150383, 3911, 328891, 43973, 90523, 99719, 253741, 205187, 368471, 223439, 297793, 150053, 310229, 277331, 42557, 187111, 4933, 1451, 281033})));
        System.out.println(Arrays.toString(solve(1111,new int[]{ 181, 206033, 63199, 306157, 214499, 172649, 122029, 342197, 312197, 280409, 56249, 326737, 265619, 185917, 104311, 3527, 27409, 127541, 46723, 53299, 381287, 159097, 36793, 887, 1913, 132661, 193057, 208991, 221261, 223423, 53419, 246193, 161039, 122701, 16069, 223637, 295769, 303691, 188443, 103561, 333779, 272093, 367229, 354451, 196181, 44893, 165587, 78583, 328051, 69163, 294181, 320401, 384733, 385943, 225221, 138209, 90071, 101737, 319069, 5927, 131891, 27803, 251861, 15797, 1879, 351691, 93629, 92593, 215723, 257671, 318107, 272009, 174673, 67547, 279137, 168193, 163901, 364499, 279511, 33107, 220169, 135511, 275573, 224201, 209441, 126229, 48259, 74821, 150989, 303817, 187277, 381859, 282299, 120277, 54421, 243889, 177433, 18181, 261229, 182549, 46771, 364669, 44641, 346043, 258353, 103991, 151517, 20411, 372061, 254329, 48823, 334379, 311659, 213289, 62467, 57529, 309667, 170851, 49633, 182179, 274333, 143401, 95063, 208009, 253937, 284159, 270163, 170857, 38197, 128749, 316907, 9293, 187223, 246173, 151391, 31981, 364571, 352711, 200293, 120431, 169567, 131519, 321821, 109201, 163169, 92243, 378919, 101921, 277231, 207481, 64109, 286453, 318809, 140269, 181001, 339769, 7001, 383839, 209519, 14033, 192961, 63463, 320149, 231271, 244033, 64879, 319831, 38299, 33623, 278879, 108191, 361213, 97499, 116731, 44171, 274831, 316891, 264643, 220687, 280627, 85049, 45691, 251, 17389, 305111, 324223, 69497, 35591, 201809, 3323, 34949, 162593, 282589, 255511, 197837, 21577, 155453, 66361, 259691, 99109, 155443, 77527, 211507, 193451, 232007, 51329, 182279, 370471, 259531, 354139, 61933, 116539, 57709, 384079, 163697, 385261, 29411, 230551, 28433, 155783, 357031, 13397, 341629, 98993, 75617, 289721, 145463, 66373, 231779, 222199, 161377, 167267, 219749, 234613, 325021, 314491, 230383, 269713, 206909, 131611, 59743, 276707, 202591, 346039, 81343, 61553, 222461, 260677, 214363, 122389, 178513, 23677, 277897, 225427, 228797, 257639, 304481, 47389, 210811, 330331, 348637, 226511, 272417, 11821, 248063, 376099, 108533, 208213, 104971, 56179, 33199, 330877, 323597, 279443, 49409, 113089, 23327, 22447, 237271, 310867, 198469, 160049, 144751, 102217, 167017, 181141, 48647, 111623, 276763, 108127, 313669, 368579, 332711, 271393, 102679, 362347, 39667, 18947, 296437, 190313, 224461, 367307, 21061, 333667, 242453, 111253, 32027, 182627, 75541, 99089, 352181, 200989, 246119, 35227, 177787, 133109, 179381, 299993, 184279, 134363, 256313, 193301, 223099, 139333, 1181, 264601, 30553, 229763, 328481, 177269, 280697, 179407, 133481, 296563, 201673, 124633, 367163, 232937, 57073, 131251, 41213, 278911, 365527, 225373, 7127, 114217, 15731, 236527, 41213, 321833, 328961, 219407, 270059, 324757, 3449, 39371, 264619, 227501, 72031, 19031, 54413, 230143, 118493, 110233, 128659, 245383, 303619, 305401, 191099, 225077, 301907, 344171, 45823, 232669, 142031, 85427, 42793, 325189, 19087, 151909, 209801, 103669, 199697, 74941, 107069, 33857, 305839, 42223, 96763, 297719, 341911, 298349, 279173, 226697, 126143, 325769, 76039, 328637, 76423, 83843, 197419, 379667, 15101, 24001, 190339, 151579, 28537, 87337, 340393, 77617, 46471, 38921, 357083, 23603, 12967, 16649, 116789, 349939, 140617, 153929, 363317, 317921, 194083, 319819, 258607, 140281, 87509, 823, 190717, 366841, 140639, 80737, 214691, 85991, 254753, 362951, 154981, 339811, 1487, 361159, 221203, 296831, 211063, 44927, 73819, 134677, 811, 148249, 24229, 244873, 325163, 18583, 307079, 245759, 257797, 303727, 192547, 255259, 45061, 256939, 272537, 293269, 8101, 330731, 238727, 264029, 25409, 201359, 363959, 16657, 93283, 45959, 378407, 228619, 99823, 353161, 128657, 258977, 72421, 49757, 80557, 189043, 344843, 32503, 344963, 157411, 23603, 295153, 55457, 375247, 292493, 331451, 69539, 163367, 683, 281923, 35069, 142969, 106963, 383041, 10313, 84787, 61651, 83101, 48947, 228773, 337691, 360197, 63977, 294181, 239171, 243647, 347707, 162901, 352637, 246641, 47947, 235231, 208319, 149771, 361967, 196717, 211789, 195053, 86029, 139987, 122027, 9739, 300743, 64319, 20393, 136999, 216917, 20627, 64811, 49747, 238673, 162527, 222311, 260191, 157259, 254911, 139831, 317351, 217463, 65519, 364621, 333787, 137941, 380819, 60149, 342077, 210173, 157543, 231463, 264839, 13757, 97283, 87803, 144223, 341951, 265513, 272777, 342233, 138617, 140191, 345571, 106109, 136531, 208697, 123289, 275047, 279863, 276079, 277309, 43867, 65677, 92467, 253307, 348457, 128761, 187471, 33487, 346961, 66763, 187633, 242819, 156139, 256093, 27031, 23417, 22153, 7121, 123821, 105527, 260179, 45007, 139199, 19603, 251263, 271357, 65171, 258737, 226907, 242867, 198047, 29717, 198593, 13757, 375283, 166409, 373447, 272533, 192833, 252979, 258329, 130379, 136727, 13873, 306533, 54601, 17341, 106759, 296213, 70241, 111149, 174583, 1993, 156719, 183707, 222979, 285151, 141551, 121867, 320039, 361679, 229837, 384941, 14969, 205703, 328633, 136099, 105251, 96757, 6803, 225613, 137723, 4507, 8093, 162997, 326309, 359137, 141829, 272329, 225241, 305999, 333539, 213533, 218657, 23203, 299933, 165617, 216877, 216379, 208213, 309241, 250007, 119563, 2267, 90481, 118739, 77419, 290489, 130259, 331249, 36061, 271637, 232103, 341333, 59351, 194717, 344749, 294317, 371389, 64667, 344497, 301601, 366227, 322571, 339839, 232013, 60217, 227453, 89659, 84247, 274441, 297719, 55117, 266983, 173081, 24019, 305243, 325231, 38749, 105613, 209789, 170021, 286697, 62633, 272453, 384017, 3607, 240007, 257867, 56263, 21017, 93283, 251609, 318601, 203227, 130057, 294149, 77551, 236107, 77267, 67289, 373969, 95791, 5701, 289763, 48371, 12923, 2003, 121367, 238463, 119417, 146933, 147671, 27103, 198503, 260999, 117361, 244003, 333923, 194687, 208493, 15149, 167071, 87721, 151579, 328519, 175447, 26053, 206917, 265193, 293659, 328919, 323341, 100151, 329009, 238879, 280537, 314407, 288359, 332069, 347287, 349093, 189307, 156841, 32917, 123449, 312233, 151897, 54709, 109, 243973, 291491, 18229, 26839, 135647, 254729, 305633, 49123, 45119, 13399, 120551, 4483, 376891, 240007, 15061, 349787, 235783, 153457, 5189, 81223, 138053, 242509, 295049, 5689, 313399, 43543, 234461, 200671, 379103, 166183, 71081, 103001, 295199, 119101, 172969, 223823, 31183, 379501, 284153, 47977, 163307, 266083, 385571, 292363, 237619, 229127, 363277, 256313, 98927, 207457, 99119, 199753, 266369, 82609, 199103, 177811, 365641, 248821, 288181, 229847, 159119, 302189, 279967, 381413, 67307, 232391, 347969, 217169, 351479, 182813, 176461, 160649, 339389, 360869, 59281, 84731, 66749, 273719, 361219, 230501, 11197, 237401, 9133, 203051, 198257, 159349, 17489, 384403, 39839, 220907, 13997, 55813, 245029, 115259, 108907, 242371, 145417, 151813, 73561, 252391, 53527, 179603, 183593, 303731, 154799, 859, 117889, 131893, 40123, 313931, 274871, 340201, 238247, 241229, 186239, 275159, 276389, 367721, 167081, 127037, 34421, 345817, 311419, 162683, 33247, 331081, 286459, 10487, 147727, 358879, 19577, 52957, 69847, 36073, 217081, 36583, 227993, 212467, 257293, 274163, 350429, 248789, 102139, 306193, 132749, 385057, 291077, 67219, 54983, 136573, 58699, 212897, 63949, 369079, 62017, 134161, 104311, 37397, 65003, 12697, 290533, 286333, 335941, 277, 160183, 151451, 303337, 165331, 178627, 281527, 79813, 204361, 27827, 352973, 341303, 325901, 16943, 176989, 233489, 280627, 284233, 86201, 347987, 299401, 65521, 201683, 14323, 189377, 298691, 263089, 6047, 274213, 201833, 349801, 333623, 301409, 104827, 139267, 173531, 14731, 241711, 109, 289469, 284267, 72859, 49367, 16229, 249133, 8609, 120397, 260419, 301901, 155291, 378379, 234931, 101051, 171571, 333139, 23311, 30689, 45247, 45139, 351343, 106163, 131063, 308311, 12823, 308489, 80317, 343037, 86441, 91283, 68543, 76403, 321449, 333341, 338579, 320911, 224303, 11069, 56041, 59567, 124171, 160481, 60089, 341587, 229759, 198959, 348709, 189493, 273797, 385811, 373187, 330229, 319097, 46507, 131311, 96797, 55127, 375043, 278387, 267899, 8059, 238921, 307733, 275939, 310117, 38749, 268927, 131581, 240893, 350293, 339601, 8431, 291457, 160313, 1579, 76099, 148483, 49993, 351773, 181303, 81343, 283583, 346553, 70619, 8423, 290533, 75979, 203213, 305147, 323987, 114913, 196033, 382709, 331031, 239699, 75743, 307823, 129971, 128413, 9257, 205133, 140351, 37019, 112291, 343489, 66137, 360817, 38917, 322771, 341333, 159023, 73709, 234629, 204601, 230123, 150383, 3911, 328891, 43973, 90523, 99719, 253741, 205187, 368471, 223439, 297793, 150053, 310229, 277331, 42557, 187111, 4933, 1451, 281033})));
    }
}
